!function(a,b){b["true"]=a;var c=dabl.RESTAdapter.extend({$http:null,init:function(a,b){this._super(a),this.$http=b},_getErrorCallback:function(a){return function(b,c,d,e){var f="Request failed.";b&&(b.error?f=b.error:b.errors&&(f=b.errors.join("\n"))),a.reject(f,b,e)}},_save:function(a,b){var c,d,e=a.constructor,f=this._getRoute(e._url),g={},h=e.getKey(),i=this,j=dabl.Deferred(),k=this._getErrorCallback(j);for(c in e._fields){var l=e._fields[c];d=a[c],e.isTemporalType(l.type)&&(d=this.formatDate(d,l.type)),g[c]=d}return this.$http({url:f.url(g),method:b,data:g,headers:{"X-HTTP-Method-Override":b}}).success(function(b){return i._isValidResponseObject(b,e)?(a.fromJSON(b).resetModified().setNew(!1),h&&"undefined"!=typeof a[h]&&i.cache(e._table,a[h],a),void j.resolve(a)):void k.apply(this,arguments)}).error(k),j.promise()},remove:function(a){var b=a.constructor,c=this._getRoute(b._url),d=b.getKey(),e=this,f=dabl.Deferred(),g=this._getErrorCallback(f);return this.$http({url:c.url(a.toJSON()),method:"DELETE",data:{},headers:{"X-HTTP-Method-Override":"DELETE"}}).success(function(c){return c&&(c.error||c.errors&&c.errors.length)?void g.apply(this,arguments):(d&&a[d]&&e.cache(b._table,a[d],null),void f.resolve(a))}).error(g),f.promise()},find:function(a,b){var c,d=this._getRoute(a._url),e={},f=null,g=dabl.Deferred(),h=this._getErrorCallback(g),i=this,j=a.getKey();if(!j||2!==arguments.length||"number"!=typeof b&&"string"!=typeof b)c=this.findQuery.apply(this,arguments),c.limit(1),e=c.getSimpleJSON();else{if(f=this.cache(a._table,b))return g.resolve(f),g.promise();e={},e[j]=b}return this.$http.get(d.urlGet(e)).success(function(b){return i._isValidResponseObject(b,a)?(b instanceof Array&&(b=b.shift()),void g.resolve(a.inflate(b))):void h.apply(this,arguments)}).error(h),g.promise()},findAll:function(a){var b=this.findQuery.apply(this,arguments),c=this._getRoute(a._url),d=b.getSimpleJSON(),e=dabl.Deferred(),f=this._getErrorCallback(e);return this.$http.get(c.urlGet(d)).success(function(b){return"object"!=typeof b||b.error||b.errors&&b.errors.length?void f.apply(this,arguments):(b instanceof Array||(b=[b]),void e.resolve(a.inflateArray(b)))}).error(f),e.promise()},countAll:function(a){var b=this.findQuery.apply(this,arguments).setAction(dabl.Query.ACTION_COUNT),c=this._getRoute(a._url),d=b.getSimpleJSON(),e=dabl.Deferred(),f=this._getErrorCallback(e);return this.$http.get(c.urlGet(d)).success(function(a){var b=parseInt(a.total,10);return isNaN(b)||"object"!=typeof a||a.error||a.errors&&a.errors.length?void f.apply(this,arguments):void e.resolve(b)}).error(f),e.promise()}});dabl.AngularRESTAdapter=c}({},function(){return this}());